## 组件开发总结



### 确定开发什么组件
* 多个页面使用到同一个功能模块
* 为了方便维护，需要把一个页面拆分成多个组件
* 根据组件库设计图，专门开发一套组件

###### 复用组件
<table>
  <tr>
    <td>![复用组件1](/images/how-to-dev-component/1.png)</td>
    <td>![复用组件2](/images/how-to-dev-component/2.png)</td>
  </tr>
</table>

###### 拆分组件
![拆分组件](/images/how-to-dev-component/3.jpg)



### 组件的功能
假如要开发 `Select` 组件，第一个思考的是什么？
<table>
  <tr>
    <td>![4](/images/how-to-dev-component/4.jpg)</td>
    <td style="vertical-align: top;">实现逻辑？<br/>架构设计？<br/>输入输出接口？<br/>其他？</td>
  </tr>
</table>

###### 功能场景
* 已知场景
    - 根据设计图确定功能场景（图文示例说明）
    - 从产品给出的需求确定功能场景（设计图的补充）
* 潜在场景
    - 参考竞品的功能场景（图文示例说明）
    - 依据自己的开发经验来评估功能场景是否需要（示例说明）

###### 根据设计图确定场景
[选择器设计图](https://gitlab.gridsum.com/frontend/gs-ui/component/uploads/a35a98f286e197101005f442f2c31ee1/%E5%9F%BA%E6%9C%AC%E5%8D%95%E5%A4%9A%E9%80%89%E6%8B%A9%E5%99%A8ui.jpg)
* 可以多选
* 可以搜索
* 支持禁用
* 下拉选项支持禁用


### 良好的组件设计

* 接口设计
    - 依据数据的输入输出来确定
    - 依据功能场景来确定
    - 参考竞品组件的接口设计
    - （以 select 组件来作为示例）

* 代码架构以及实现方法
    - 待补充

* 组件易用性
    - api调用（临时提示类型的组件）
    - 指令调用（临时提示类型的组件，但依赖于页面中其他元素或组件的）
    - （以modal和loading组件来作为示例）

* 组件拆分粒度，提高可扩展性
    - 以menu为例，从传入结构化的数据生成菜单到拆分成 `Menu` 和 `MenuItem`来灵活组合 （代码图文示例说明）

* 异步接口支持
    - 组件提供的钩子函数最好支持异步，使用回调或者promise
    - （具体代码实现来作为示例）

* 接口的数据校验以及校验提示
    - （具体代码实现来作为示例）

* 错误处理，组件需自行处理内部可能出现的错误
    - ui上的错误提示
    - 控制台的错误提示

* 支持多语言
    - 提取组件的文案，以 `key-value` 的形式保存到一个对象
    - 以每个国家作为一个 key 对应一个 文案对象
    - 切换国家时，则修改组件使用的文案对象为当前国家对应的文案对象

* 主题设计
    - 确定主题色，提取颜色变量（字体颜色变量、背景颜色变量、边框颜色变量等）到一个单独的变量文件进行声明
    - hover, focus, active等状态的颜色最好是通过 normal 状态的颜色计算出来的
    - 组件涉及到数值类的数据是否也以变量的形式表示？如：高度、字体大小、内外边距等



### 可访问性

* 语义化标签
    - 比如导航组件可以使用 `nav` 标签，每一项可以使用 `li` 标签

* 支持键盘操作
    - 如：modal使用 `esc` 键可以关闭
    - 多条目的组件可以使用方向键进行控制
    - （以图文作为示例说明）



### 构建

* 代码规范

* 文档
    - 示例（ui和源码）
    - 组件的输入输出（props， slot，api）
    - （以图文作为示例说明）

* 测试
    - 单元测试
    - 集成测试

* 抽离第三方依赖类库
    - 本身依赖的类库
    - 构建时新加的helper类库
    - 使用 webpack 和 rollup 的 external 接口来实现

* 支持按需加载（两种方式）
    - 直接引入需要的文件 `import 'xxx/lib/alert'`
    - 使用插件进行转译成第一种

* 构建模式
    - es 模块
    - cj 模块
    - umd 模块

* 发布npm包



### vue 开发组件技巧

* api调用的自定义渲染实现

* bem 或者 scoped ？

* npm link 方式测试构建好的组件库包


### 后续
* 组件库工作流构建
* 组件/项目维护、迭代以及发布流程